import bgpwatcher.model.Update;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;

public class DeserialiseTest {

	@Test
	public void Can_deserialise_withdrawal() throws JsonProcessingException {
		Update update = new ObjectMapper().readValue("""
			{"type":"ris_message","data":{"timestamp":1726006008.640,"peer":"2a02:47a0:a::1","peer_asn":"49673","id":"2a02:47a0:a::1-0191ddf99b400019","host":"rrc00.ripe.net","type":"UPDATE","path":[],"community":[],"announcements":[],"withdrawals":["2406:da68:8040:0:0:0:0:0/46","2804:8c7c:9800:0:0:0:0:0/38","2406:daa0:4888:0:0:0:0:0/46","2408:8459:b020:0:0:0:0:0/44","2602:814:ffeb:0:0:0:0:0/48","2001:1248:a5ae:0:0:0:0:0/48","2800:5f0:1500:0:0:0:0:0/48","2406:da69:8040:0:0:0:0:0/46","2408:845a:b020:0:0:0:0:0/44","2803:15e0:600:0:0:0:0:0/40","2804:54a8:4000:0:0:0:0:0/34","2804:14e8:0:0:0:0:0:0/32","2001:4430:d18c:0:0:0:0:0/47","2408:8456:b020:0:0:0:0:0/44","2404:bf40:a601:0:0:0:0:0/48","2a00:10e8:2:0:0:0:0:0/48","2a00:12e8:0:0:0:0:0:0/32","2a00:12e8:0:0:0:0:0:0/40","2404:bf40:a700:0:0:0:0:0/48","2001:df0:1400:0:0:0:0:0/48","2804:14ec:0:0:0:0:0:0/33","2400:dc20:c000:0:0:0:0:0/36","2001:1248:aca7:0:0:0:0:0/48","2406:daa0:4080:0:0:0:0:0/46","2001:df1:1400:0:0:0:0:0/48","2404:bf40:a106:0:0:0:0:0/48","2408:84e1:90:0:0:0:0:0/44","2404:bf40:a205:0:0:0:0:0/48","2606:3dc0:2005:0:0:0:0:0/48","2600:1fa0:4140:0:0:0:0:0/44","2600:1fa0:4140:0:0:0:0:0/46","2803:1a00:1119:0:0:0:0:0/48","2600:1f1f:0:0:0:0:0:0/36","2600:1f1f:0:0:0:0:0:0/37","2a04:f580:9270:0:0:0:0:0/48","2803:1810:a:0:0:0:0:0/48","2806:310:14:0:0:0:0:0/48","2804:1510:0:0:0:0:0:0/32","2804:1510:0:0:0:0:0:0/34","2600:9000:1e91:0:0:0:0:0/48","2600:1f1e:0:0:0:0:0:0/36","2600:1f1e:0:0:0:0:0:0/38","2602:80d:1005:0:0:0:0:0/48","2806:20d:1e0b:0:0:0:0:0/48","2a0c:4f41:5000:0:0:0:0:0/38","2001:579:637e:0:0:0:0:0/48","2a00:1310:0:0:0:0:0:0/32","2a02:26f7:e7d0:0:0:0:0:0/48","2600:1f1c:0:0:0:0:0:0/38","2600:1f1c:0:0:0:0:0:0/36","2600:141b:b:0:0:0:0:0/48","2806:20d:180d:0:0:0:0:0/48","2804:7114:165:0:0:0:0:0/48","2409:8904:1d80:0:0:0:0:0/44","2001:1248:555f:0:0:0:0:0/48","2803:1a00:151d:0:0:0:0:0/48","240e:309:1000:0:0:0:0:0/39","2806:20d:190c:0:0:0:0:0/48","2404:3100:1830:0:0:0:0:0/44","2400:e5e0:f800:0:0:0:0:0/40","240e:108:1002:0:0:0:0:0/48","240e:308:1000:0:0:0:0:0/39","240e:982:9a80:0:0:0:0:0/41","2a01:9700:1590:0:0:0:0:0/44","240e:30b:1000:0:0:0:0:0/39","2806:1016:7:0:0:0:0:0/48","240e:44d:5740:0:0:0:0:0/42","240e:108:1200:0:0:0:0:0/44","240e:30a:1000:0:0:0:0:0/39","2600:1f18:0:0:0:0:0:0/33","2600:1f18:0:0:0:0:0:0/35","2001:1248:5953:0:0:0:0:0/48","240e:423:3720:0:0:0:0:0/44","2001:4830:2070:0:0:0:0:0/48","2806:20d:1500:0:0:0:0:0/40","2600:1f16:0:0:0:0:0:0/38","2600:1f16:0:0:0:0:0:0/34","2600:1f16:0:0:0:0:0:0/35","2600:1f16:0:0:0:0:0:0/36","2001:1248:5b51:0:0:0:0:0/48","2600:1f15:0:0:0:0:0:0/36","2600:1f15:0:0:0:0:0:0/38","2603:4:100c:0:0:0:0:0/48","2a01:c50f:17c0:0:0:0:0:0/42","2806:20d:1702:0:0:0:0:0/48","2804:30c:1600:0:0:0:0:0/40","2001:1248:5a50:0:0:0:0:0/48","2600:1f14:0:0:0:0:0:0/35","2600:1f14:0:0:0:0:0:0/37","2600:1f14:0:0:0:0:0:0/34","2806:20d:1005:0:0:0:0:0/48","2001:1248:5d57:0:0:0:0:0/48","2600:1f13:0:0:0:0:0:0/36","2405:100:1009:0:0:0:0:0/48","2405:800:1000:0:0:0:0:0/36","2001:1248:5c56:0:0:0:0:0/48","2804:151c:0:0:0:0:0:0/32","2600:1f12:0:0:0:0:0:0/38","2600:1f12:0:0:0:0:0:0/36","2805:f10:f14:0:0:0:0:0/48","2001:1248:5f55:0:0:0:0:0/48","2806:30f:1004:0:0:0:0:0/48","2600:9000:119e:0:0:0:0:0/48","2600:1f11:0:0:0:0:0:0/36","2600:1f11:0:0:0:0:0:0/38","2806:101e:7:0:0:0:0:0/48","2602:fb10:e6:0:0:0:0:0/48","2600:3c0f:23:0:0:0:0:0/48","2001:579:716c:0:0:0:0:0/46","2001:1808:0:0:0:0:0:0/32","2a02:26f7:f5c2:0:0:0:0:0/48","2a03:5000:141:0:0:0:0:0/48","2600:80d:17:0:0:0:0:0/48","2a02:26f7:f6c1:0:0:0:0:0/48","2001:1248:4349:0:0:0:0:0/48","2a00:1300:0:0:0:0:0:0/32","2a0d:5600:48:0:0:0:0:0/48","2a13:0:0:0:0:0:0:0/29","2a05:6200:74:0:0:0:0:0/48","2a06:1700:2:0:0:0:0:0/48","2a03:1000:0:0:0:0:0:0/32","2a04:1700:0:0:0:0:0:0/29","2a02:26f7:f7c0:0:0:0:0:0/48","2a10:300:0:0:0:0:0:0/29","2a07:1400:0:0:0:0:0:0/29","2a0d:200:1c:0:0:0:0:0/48","2a0a:1900:0:0:0:0:0:0/29","2804:3720:2200:0:0:0:0:0/40","2402:7500:963:0:0:0:0:0/48","2001:1248:454f:0:0:0:0:0/48","2803:1a00:50d:0:0:0:0:0/48","2600:8807:d9a:0:0:0:0:0/47","2408:8409:190:0:0:0:0:0/44","2001:1248:444e:0:0:0:0:0/48","2408:8957:5cc0:0:0:0:0:0/44","2408:8956:5cc0:0:0:0:0:0/44","2620:138:300e:0:0:0:0:0/48","2605:5240:4800:0:0:0:0:0/37","2605:5240:4800:0:0:0:0:0/40","2600:1408:b:0:0:0:0:0/48","2801:16:1000:0:0:0:0:0/48","2402:7500:a60:0:0:0:0:0/44","2001:1248:464c:0:0:0:0:0/48","2602:817:1005:0:0:0:0:0/48","2402:7500:56f:0:0:0:0:0/48","2400:9800:580:0:0:0:0:0/45","2803:f10:1904:0:0:0:0:0/48","2001:1800:0:0:0:0:0:0/32","2402:7500:46e:0:0:0:0:0/48","2408:8406:190:0:0:0:0:0/44","2606:2800:534:0:0:0:0:0/48","2409:8087:8014:0:0:0:0:0/48","2001:1248:4b41:0:0:0:0:0/48","2606:2800:435:0:0:0:0:0/48","2001:1388:8a81:0:0:0:0:0/48","2001:1248:4a40:0:0:0:0:0/42","2001:1248:4a40:0:0:0:0:0/48","2620:123:201e:0:0:0:0:0/48","2001:1248:4d47:0:0:0:0:0/48","2405:1800:0:0:0:0:0:0/32","2606:2800:233:0:0:0:0:0/48","2804:150c:0:0:0:0:0:0/32","2600:1802:7:0:0:0:0:0/48","2606:2800:130:0:0:0:0:0/48","2001:1248:4f45:0:0:0:0:0/48","2604:1a00:1:0:0:0:0:0/48","2604:200:19:0:0:0:0:0/48","2001:1838:0:0:0:0:0:0/32","2804:1530:0:0:0:0:0:0/32","2402:8100:39a7:0:0:0:0:0/48","2a00:1d32:50b:0:0:0:0:0/48","2a00:1d32:40a:0:0:0:0:0/48","2804:1534:0:0:0:0:0:0/32","2804:4a28:1f40:0:0:0:0:0/46","2804:4a28:1f40:0:0:0:0:0/45","2a00:1d32:709:0:0:0:0:0/48","2a00:1d32:608:0:0:0:0:0/48","2409:8907:3da0:0:0:0:0:0/44","2a00:1d35:e00:0:0:0:0:0/40","2804:14c:7561:0:0:0:0:0/48","2001:930:110:0:0:0:0:0/48","2a00:1d34:e00:0:0:0:0:0/40","2804:1538:0:0:0:0:0:0/32","2804:1538:0:0:0:0:0:0/33","2804:1338:6:0:0:0:0:0/48","2a00:1d37:e00:0:0:0:0:0/40","2408:8406:31a0:0:0:0:0:0/44","2a00:1d36:e00:0:0:0:0:0/40","2a00:1338:0:0:0:0:0:0/32","2a01:53c0:ffbe:0:0:0:0:0/48","2402:8100:31af:0:0:0:0:0/48","2402:8100:30ae:0:0:0:0:0/48","2a0a:6040:7c05:0:0:0:0:0/48","2a0a:6044:7801:0:0:0:0:0/48","2806:103e:7:0:0:0:0:0/48","2600:9000:30bf:0:0:0:0:0/48","2804:6450:7100:0:0:0:0:0/40","2804:1520:0:0:0:0:0:0/32","2001:1828:0:0:0:0:0:0/32","2600:1f2e:0:0:0:0:0:0/36","2806:230:1306:0:0:0:0:0/48","2602:80c:2035:0:0:0:0:0/48","2a01:620:14:0:0:0:0:0/48","2600:1f2c:0:0:0:0:0:0/36","2806:230:1500:0:0:0:0:0/48","2806:230:1401:0:0:0:0:0/48","2600:1f69:4040:0:0:0:0:0/46","2600:1f68:4040:0:0:0:0:0/46","2600:1f28:0:0:0:0:0:0/36","2804:14c:6571:0:0:0:0:0/48","2804:1638:1112:0:0:0:0:0/48","2600:9000:27a8:0:0:0:0:0/48","2001:1820:0:0:0:0:0:0/32","2001:49f0:d081:0:0:0:0:0/48","2600:9000:26a9:0:0:0:0:0/48","2804:1528:0:0:0:0:0:0/32","2804:1528:0:0:0:0:0:0/33","2600:1f26:0:0:0:0:0:0/36","2600:9000:25aa:0:0:0:0:0/48","2600:1f25:0:0:0:0:0:0/36","2804:1080:aaaf:0:0:0:0:0/48","2600:1f24:0:0:0:0:0:0/36","2600:9000:24ab:0:0:0:0:0/48","2600:9000:23ac:0:0:0:0:0/48","2600:9000:22ad:0:0:0:0:0/48","2600:1f22:0:0:0:0:0:0/36","2a02:2e02:2f10:0:0:0:0:0/44","2600:9000:21ae:0:0:0:0:0/48","2600:1f21:0:0:0:0:0:0/36","2a0e:1a80:acab:0:0:0:0:0/48","2806:102e:7:0:0:0:0:0/48","2600:1fa0:8080:0:0:0:0:0/46","2600:1fa0:8080:0:0:0:0:0/44","2600:9000:20af:0:0:0:0:0/48","2001:559:11c:0:0:0:0:0/48","2806:250:15:0:0:0:0:0/48","2a00:1851:b:0:0:0:0:0/48","2001:559:21f:0:0:0:0:0/48","2001:559:31e:0:0:0:0:0/48","2001:559:419:0:0:0:0:0/48","2a0f:cc87:d000:0:0:0:0:0/36","2001:559:518:0:0:0:0:0/48","2804:1554:0:0:0:0:0:0/32","2804:1554:0:0:0:0:0:0/33","2001:559:71a:0:0:0:0:0/48","2803:5450:640:0:0:0:0:0/42","240e:44d:1700:0:0:0:0:0/42","2804:3774:2200:0:0:0:0:0/40","2804:14d:1400:0:0:0:0:0/40","2804:145c:504:0:0:0:0:0/48","2804:4158:54:0:0:0:0:0/48","2804:1558:0:0:0:0:0:0/32","2605:b40:1100:0:0:0:0:0/40","2806:105e:7:0:0:0:0:0/48","2001:67c:2a34:0:0:0:0:0/48","2803:2540:136:0:0:0:0:0/48","2a04:4e42:59:0:0:0:0:0/48","2804:1540:0:0:0:0:0:0/32","2804:1540:0:0:0:0:0:0/33","2804:2570:3000:0:0:0:0:0/36","2801:140:11:0:0:0:0:0/48","2803:1240:0:0:0:0:0:0/32","2803:1240:0:0:0:0:0:0/48","2803:2540:37:0:0:0:0:0/48","2a04:4e41:59:0:0:0:0:0/48","2402:7280:cfa2:0:0:0:0:0/48","2a05:4140:156:0:0:0:0:0/48","2a00:86c0:8015:0:0:0:0:0/48","2a0e:1c40:1:0:0:0:0:0/48","2a13:40:0:0:0:0:0:0/32","2a13:240:2:0:0:0:0:0/48","2a0e:1d40:0:0:0:0:0:0/29","2a12:140:0:0:0:0:0:0/29","2a0b:1940:1:0:0:0:0:0/48","2a0f:1c40:0:0:0:0:0:0/29","2a05:541:112:0:0:0:0:0/48","2a03:1040:0:0:0:0:0:0/32","2a0c:4f47:50:0:0:0:0:0/46","2804:5504:4000:0:0:0:0:0/34","240e:108:4052:0:0:0:0:0/48","2806:370:3420:0:0:0:0:0/44","2408:8957:1c80:0:0:0:0:0/44","2804:1644:300:0:0:0:0:0/42","2408:8956:1c80:0:0:0:0:0/44","2a02:26f7:b384:0:0:0:0:0/48","2804:1548:0:0:0:0:0:0/32","2a0c:b641:9a0:0:0:0:0:0/44","2803:1f40:d00:0:0:0:0:0/40","2401:1d40:100:0:0:0:0:0/48","2606:2800:4273:0:0:0:0:0/48","2804:550c:4000:0:0:0:0:0/35","2803:1f40:c01:0:0:0:0:0/48","2804:154c:0:0:0:0:0:0/32","2405:b40:13:0:0:0:0:0/48","2402:4e00:4011:0:0:0:0:0/48","2401:1d40:1:0:0:0:0:0/48","2a02:26f7:bb8c:0:0:0:0:0/48","2607:740:1f:0:0:0:0:0/48","2607:fb10:50b3:0:0:0:0:0/48","2606:2800:4071:0:0:0:0:0/48","2806:104e:7:0:0:0:0:0/48","2001:4878:151:0:0:0:0:0/48","2001:1248:313b:0:0:0:0:0/48","2800:370:12:0:0:0:0:0/48","2806:260:1005:0:0:0:0:0/48","2800:b70:1a:0:0:0:0:0/48","240a:6b:1700:0:0:0:0:0/40","2806:230:4055:0:0:0:0:0/48","2001:938:4051:0:0:0:0:0/48","2803:6604:7400:0:0:0:0:0/48","2804:5530:4000:0:0:0:0:0/34","2804:1570:0:0:0:0:0:0/33","2804:1570:0:0:0:0:0:0/32","2001:1248:3339:0:0:0:0:0/48","2001:67c:618:0:0:0:0:0/48","2a00:1370:0:0:0:0:0:0/32","2001:1248:3238:0:0:0:0:0/48","2409:8914:6df0:0:0:0:0:0/44","2804:5534:4000:0:0:0:0:0/43","2804:1574:0:0:0:0:0:0/32","2804:6504:7000:0:0:0:0:0/38","2001:1248:373d:0:0:0:0:0/48","2001:1248:363c:0:0:0:0:0/48","2804:8774:290:0:0:0:0:0/45","2804:1578:0:0:0:0:0:0/32","2620:74:3f:0:0:0:0:0/48","2001:678:a14:0:0:0:0:0/48","2409:8c1e:68f0:0:0:0:0:0/48","2607:fb90:e300:0:0:0:0:0/40","2602:27d:f10:0:0:0:0:0/48","2804:553c:4000:0:0:0:0:0/35","2804:157c:0:0:0:0:0:0/33","2804:157c:0:0:0:0:0:0/32","2804:157c:0:0:0:0:0:0/34","2804:157c:0:0:0:0:0:0/36","2806:107e:7:0:0:0:0:0/48","240e:37d:1000:0:0:0:0:0/37","2001:1248:212b:0:0:0:0:0/48","2806:1060:106:0:0:0:0:0/48","2001:1868:0:0:0:0:0:0/32","2001:579:110c:0:0:0:0:0/46","2a0a:4a40:2271:0:0:0:0:0/48","240e:37c:1000:0:0:0:0:0/37","2804:1560:0:0:0:0:0:0/32","240e:37f:1000:0:0:0:0:0/37","2a05:7640:2040:0:0:0:0:0/42","240e:37e:1000:0:0:0:0:0/37","2800:370:1200:0:0:0:0:0/48","2806:2f0:9580:0:0:0:0:0/47","2806:2f0:9580:0:0:0:0:0/43","240e:379:1000:0:0:0:0:0/37","2804:574:1000:0:0:0:0:0/48","2804:1564:0:0:0:0:0:0/33","2804:5524:4000:0:0:0:0:0/34","240e:378:1000:0:0:0:0:0/37","2804:1564:0:0:0:0:0:0/32","2401:7400:6800:0:0:0:0:0/48","2806:2f0:9782:0:0:0:0:0/48","240e:37b:1000:0:0:0:0:0/37","240e:37a:1000:0:0:0:0:0/37","2001:16a2:c3cd:0:0:0:0:0/48","2001:1260:10b:0:0:0:0:0/48","2804:c90:f9e0:0:0:0:0:0/43","2a13:aac1:aa00:0:0:0:0:0/40","2001:579:1904:0:0:0:0:0/46","2001:1860:0:0:0:0:0:0/32","2804:1568:0:0:0:0:0:0/32","2a13:aac0:aa00:0:0:0:0:0/40","2001:16a2:c2cc:0:0:0:0:0/48","2001:16a2:c2cc:0:0:0:0:0/47","2001:16a2:c2cc:0:0:0:0:0/46","2a13:aac3:aa00:0:0:0:0:0/40","2001:16a2:c0ce:0:0:0:0:0/47","2001:1260:208:0:0:0:0:0/45","2001:16a2:c0ce:0:0:0:0:0/48","2a13:aac2:aa00:0:0:0:0:0/40","2a13:aac5:aa00:0:0:0:0:0/40","2401:b60:17:0:0:0:0:0/48","2a13:aac4:aa00:0:0:0:0:0/40","2400:bde0:8020:0:0:0:0:0/47","2402:800:6374:0:0:0:0:0/48","2a13:aac7:aa00:0:0:0:0:0/40","2607:3c40:2004:0:0:0:0:0/46","2a02:578:1400:0:0:0:0:0/38","2401:b60:215:0:0:0:0:0/48","2a13:aac6:aa00:0:0:0:0:0/40","2801:16e:11:0:0:0:0:0/48","2600:1fa0:c0c0:0:0:0:0:0/44","2600:1fa0:c0c0:0:0:0:0:0/46","2408:840c:9100:0:0:0:0:0/40","2a14:7c0:5353:0:0:0:0:0/48","240e:983:1e04:0:0:0:0:0/48","2402:3a80:1c39:0:0:0:0:0/48","2408:840d:9100:0:0:0:0:0/43","2803:1a90:8:0:0:0:0:0/48","2804:1590:0:0:0:0:0:0/32","2804:1590:0:0:0:0:0:0/33","2803:9210:8000:0:0:0:0:0/35","2804:4590:50:0:0:0:0:0/44","2800:c90:1d:0:0:0:0:0/48","2803:9800:901a:0:0:0:0:0/48","2804:214:8790:0:0:0:0:0/44","2001:559:c2df:0:0:0:0:0/48","2800:486:1500:0:0:0:0:0/40","2001:579:e2ff:0:0:0:0:0/48","2800:190:313:0:0:0:0:0/48","2800:300:9280:0:0:0:0:0/44","2a02:85f:cfd6:0:0:0:0:0/48","2804:1638:aaa9:0:0:0:0:0/48","2001:559:c4d9:0:0:0:0:0/48","240e:983:1a00:0:0:0:0:0/40","240e:983:1a00:0:0:0:0:0/41","2402:3a80:193c:0:0:0:0:0/46","2408:8409:9100:0:0:0:0:0/44","2804:66e4:7003:0:0:0:0:0/48","240e:983:1b01:0:0:0:0:0/48","2408:8957:cc50:0:0:0:0:0/44","2408:8956:cc50:0:0:0:0:0/44","2402:3a80:1a3f:0:0:0:0:0/48","2409:8a04:9e00:0:0:0:0:0/40","2a00:1880:1b10:0:0:0:0:0/46","2409:8958:cd50:0:0:0:0:0/46","2a00:139b:0:0:0:0:0:0/32","2001:1890:0:0:0:0:0:0/29","2407:d700:9459:0:0:0:0:0/48","2409:8959:cd50:0:0:0:0:0/46","2403:49c0:5700:0:0:0:0:0/40","2408:8406:9100:0:0:0:0:0/44","2402:3a80:1732:0:0:0:0:0/48","2a01:c50f:9740:0:0:0:0:0/42","2a00:1398:0:0:0:0:0:0/32","2a00:1398:0:0:0:0:0:0/29","2407:d700:915c:0:0:0:0:0/48","2407:d700:905d:0:0:0:0:0/48","2804:179c:2:0:0:0:0:0/48","2a02:2e02:9fa0:0:0:0:0:0/44","2806:109f:7:0:0:0:0:0/48","2407:d700:925f:0:0:0:0:0/48","2606:a80:1003:0:0:0:0:0/48","2a00:139c:0:0:0:0:0:0/32","2001:1388:10a:0:0:0:0:0/47","2a0b:f380:3e8:0:0:0:0:0/48","2409:8910:9d00:0:0:0:0:0/40","2a0d:5082:4e:0:0:0:0:0/48","2803:1780:5:0:0:0:0:0/48","2804:1580:0:0:0:0:0:0/32","2803:1180:3:0:0:0:0:0/48","2803:32a0:2000:0:0:0:0:0/35","2a0f:1e81:2:0:0:0:0:0/48","2409:8b10:9f00:0:0:0:0:0/40","2606:f4c0:4da0:0:0:0:0:0/44","2a0a:1980:0:0:0:0:0:0/29","2a0e:1c80:1:0:0:0:0:0/48","2a0b:1880:0:0:0:0:0:0/48","2a07:1480:0:0:0:0:0:0/29","2409:8a10:9e00:0:0:0:0:0/40","2a0f:1c80:0:0:0:0:0:0/29","2806:2f0:7560:0:0:0:0:0/47","2408:8957:dc40:0:0:0:0:0/44","2408:8956:dc40:0:0:0:0:0/44","2606:b400:8825:0:0:0:0:0/48","2409:8a14:9e00:0:0:0:0:0/39","2800:98:1100:0:0:0:0:0/44","2800:98:1100:0:0:0:0:0/40","2402:3a80:520:0:0:0:0:0/44","2800:88:11:0:0:0:0:0/48","2804:1588:0:0:0:0:0:0/32","2804:1588:0:0:0:0:0:0/33","240e:397:1000:0:0:0:0:0/40","2a02:88d:21b:0:0:0:0:0/48","2804:158c:0:0:0:0:0:0/32","2400:7de0:6000:0:0:0:0:0/36","2402:9d80:381:0:0:0:0:0/48","2a02:88d:19:0:0:0:0:0/48","2409:8710:9300:0:0:0:0:0/40","2606:1980:0:0:0:0:0:0/48","2604:1280:9:0:0:0:0:0/48","2604:4580:5e:0:0:0:0:0/48","2402:9d80:280:0:0:0:0:0/48","2402:1b80:206:0:0:0:0:0/48","2605:380:19:0:0:0:0:0/48","2408:8a22:9f00:0:0:0:0:0/40","2408:822a:9700:0:0:0:0:0/40","2409:8920:9d00:0:0:0:0:0/40","2001:18b8:0:0:0:0:0:0/32","2803:9800:b03a:0:0:0:0:0/48","2804:11b0:4:0:0:0:0:0/48","2409:8a20:9e00:0:0:0:0:0/40","2a00:13b7:0:0:0:0:0:0/48","2408:862a:9300:0:0:0:0:0/40","2804:15b4:101:0:0:0:0:0/48","2806:2a0:1500:0:0:0:0:0/40","2806:2a0:1500:0:0:0:0:0/45","2409:8904:bd20:0:0:0:0:0/44","2804:15b4:0:0:0:0:0:0/32","2409:8c20:9800:0:0:0:0:0/40","2408:8957:ec70:0:0:0:0:0/44","2409:8728:9300:0:0:0:0:0/40","2408:8956:ec70:0:0:0:0:0/44","2409:8729:9300:0:0:0:0:0/40","2804:14c:f4e0:0:0:0:0:0/45","2409:8929:9d00:0:0:0:0:0/40","2600:1005:b1be:0:0:0:0:0/48","2409:8a28:9e00:0:0:0:0:0/40","2804:3b8:214:0:0:0:0:0/48","2401:1d80:3130:0:0:0:0:0/46","2400:cd60:d000:0:0:0:0:0/36","2804:15bc:0:0:0:0:0:0/32","2804:179c:2022:0:0:0:0:0/48","2409:8720:9300:0:0:0:0:0/40","2409:8c2b:9800:0:0:0:0:0/40","2605:6ac0:7000:0:0:0:0:0/36","2001:ee0:5640:0:0:0:0:0/42","2806:10be:7:0:0:0:0:0/48","2a03:7380:2340:0:0:0:0:0/42","2803:12a0:0:0:0:0:0:0/32","2803:9800:a02a:0:0:0:0:0/48","2a00:13a0:0:0:0:0:0:0/32","2620:1bc:102e:0:0:0:0:0/47","2409:8a30:9e00:0:0:0:0:0/40","2806:2f0:5540:0:0:0:0:0/47","2408:8459:f160:0:0:0:0:0/44","2405:1c0:6871:0:0:0:0:0/48","2804:15a4:0:0:0:0:0:0/32","2804:55e4:4000:0:0:0:0:0/34","2804:15a4:0:0:0:0:0:0/33","2600:1f69:c0c0:0:0:0:0:0/46","2806:10a6:7:0:0:0:0:0/48","2600:1f68:c0c0:0:0:0:0:0/46","2001:16a4:50b:0:0:0:0:0/48","2400:cb00:a472:0:0:0:0:0/48","2400:cb00:a771:0:0:0:0:0/48","2001:16a4:608:0:0:0:0:0/48","2001:16a2:e:0:0:0:0:0/47","2400:cb00:a670:0:0:0:0:0/48","2409:8a38:9e00:0:0:0:0:0/39","2402:e280:21dc:0:0:0:0:0/48","2806:2a0:d18:0:0:0:0:0/45","2801:bc:1000:0:0:0:0:0/36","2804:15ac:0:0:0:0:0:0/32","2001:16a4:e:0:0:0:0:0/48","2001:16a4:e:0:0:0:0:0/47","2001:16a4:20c:0:0:0:0:0/48","2400:cb00:a274:0:0:0:0:0/48","2001:16a4:20c:0:0:0:0:0/47","2607:f740:e00f:0:0:0:0:0/48","2806:10ae:7:0:0:0:0:0/48","2001:18d8:0:0:0:0:0:0/32","2001:559:819c:0:0:0:0:0/48","2804:5590:4000:0:0:0:0:0/36","2804:5590:4000:0:0:0:0:0/34","2a05:e740:9160:0:0:0:0:0/48","2a05:6c0:1000:0:0:0:0:0/36","2001:559:839e:0:0:0:0:0/48","2a00:13d0:0:0:0:0:0:0/32","2a00:13d0:0:0:0:0:0:0/29","2001:13d2:803:0:0:0:0:0/48","2803:c600:d400:0:0:0:0:0/40","2001:4490:4c10:0:0:0:0:0/46","2001:559:869b:0:0:0:0:0/48","2801:c4:1303:0:0:0:0:0/48","2001:559:879a:0:0:0:0:0/48","2409:8a44:9e00:0:0:0:0:0/40","2001:19d0:100:0:0:0:0:0/40","2001:4490:401c:0:0:0:0:0/46","2804:65a8:7000:0:0:0:0:0/36","2001:1248:9892:0:0:0:0:0/48","2a01:c50e:d700:0:0:0:0:0/40","2804:16d8:300:0:0:0:0:0/40","2001:ee0:3224:0:0:0:0:0/48","2804:15dc:0:0:0:0:0:0/32","2001:1248:9c96:0:0:0:0:0/48","2a06:de00:de15:0:0:0:0:0/48","2806:3dc:14:0:0:0:0:0/48","2001:1248:9f95:0:0:0:0:0/48","2605:bc0:1001:0:0:0:0:0/48","2a12:ecc2:1ec:0:0:0:0:0/48","2602:fcce:e1:0:0:0:0:0/48","2a02:cb80:4298:0:0:0:0:0/47","2a02:cb80:4298:0:0:0:0:0/48","2804:35e0:2000:0:0:0:0:0/36","2a02:ee80:41be:0:0:0:0:0/48","2a02:ee80:41be:0:0:0:0:0/47","2a00:11c0:2:0:0:0:0:0/48","2a11:2c0:0:0:0:0:0:0/29","2a13:c0:0:0:0:0:0:0/48","2a02:cb80:409a:0:0:0:0:0/48","2a06:11c0:4:0:0:0:0:0/48","2a0a:19c0:0:0:0:0:0:0/29","2409:8a50:9e00:0:0:0:0:0/40","2a06:15c0:0:0:0:0:0:0/29","2a02:26f0:3700:0:0:0:0:0/48","2806:2f0:3520:0:0:0:0:0/48","2806:2f0:3520:0:0:0:0:0/43","2806:2f0:3520:0:0:0:0:0/47","2a14:7c7:0:0:0:0:0:0/32","2409:8904:cd50:0:0:0:0:0/44","2800:bf0:342e:0:0:0:0:0/48","2804:15c4:0:0:0:0:0:0/32","2408:8957:9c00:0:0:0:0:0/44","2409:8a55:9e00:0:0:0:0:0/40","2408:8956:9c00:0:0:0:0:0/44","2a10:4dc0:44a:0:0:0:0:0/48","2409:8907:cd50:0:0:0:0:0/44","2402:3a80:4560:0:0:0:0:0/44","2804:15c8:0:0:0:0:0:0/48","2402:3a80:4461:0:0:0:0:0/48","2409:8754:9300:0:0:0:0:0/40","2804:14c:8793:0:0:0:0:0/48","2402:3a80:4164:0:0:0:0:0/48","2400:dc00:c001:0:0:0:0:0/48","2407:1ac0:0:0:0:0:0:0/35","2804:15cc:0:0:0:0:0:0/32","2607:9800:c141:0:0:0:0:0/48","2a02:4e0:2d38:0:0:0:0:0/46","2402:3a80:4366:0:0:0:0:0/48","2409:8750:9300:0:0:0:0:0/40","2604:1bc0:0:0:0:0:0:0/32","2600:14c0:b:0:0:0:0:0/48","2409:8a5c:9e00:0:0:0:0:0/40","2600:1fa0:6060:0:0:0:0:0/44"]}}
			""", Update.class);

		assertThat(update.getType()).isEqualTo("ris_message");
		// assertThat(update.getData().getTimestamp()).isEqualTo("1726006008.640");
		assertThat(update.getData().getPeer()).isEqualTo("2a02:47a0:a::1");
		assertThat(update.getData().getPeerAsn()).isEqualTo("49673");
		assertThat(update.getData().getId()).isEqualTo("2a02:47a0:a::1-0191ddf99b400019");
		assertThat(update.getData().getHost()).isEqualTo("rrc00.ripe.net");
		assertThat(update.getData().getType()).isEqualTo("UPDATE");
		assertThat(update.getData().getCommunity()).isEmpty();
		assertThat(update.getData().getAnnouncements()).isEmpty();
		assertThat(update.getData().getWithdrawals()).hasSize(621);
	}

	@Test
	public void Can_deserialise_announcement() throws JsonProcessingException {
		Update update = new ObjectMapper().readValue("""
			{"type":"ris_message","data":{"timestamp":1726006110.400,"peer":"2001:12f8::121","peer_asn":"42473","id":"2001:12f8::121-0191ddfb28c00031","host":"rrc15.ripe.net","type":"UPDATE","path":[42473,16735,6939,212655],"community":[[16735,5],[16735,6102],[47147,1500],[47147,2002],[47147,2104],[47147,2300],[47147,2405],[47147,2604]],"origin":"IGP","med":0,"announcements":[{"next_hop":"2001:12f8::121,fe80::9e8a:cb0a:b958:200e","prefixes":["2a0e:1d40::/29"]}],"withdrawals":[]}}
			""", Update.class);

		assertThat(update.getType()).isEqualTo("ris_message");
		assertThat(update.getData().getPeer()).isEqualTo("2001:12f8::121");
		assertThat(update.getData().getPeerAsn()).isEqualTo("42473");
		assertThat(update.getData().getId()).isEqualTo("2001:12f8::121-0191ddfb28c00031");
		assertThat(update.getData().getHost()).isEqualTo("rrc15.ripe.net");
		assertThat(update.getData().getType()).isEqualTo("UPDATE");
		assertThat(update.getData().getCommunity()).hasSize(8);
		assertThat(update.getData().getAnnouncements()).hasSize(1);
		assertThat(update.getData().getWithdrawals()).hasSize(0);
	}
}
